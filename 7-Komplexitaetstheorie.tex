\section[Komplexitätstheorie]{Komplexitätstheorie}
\subsection{Komplexitätsklassen und P/NP}

{\color{red} TODO: Dieser rote Teil des Skriptes wir erst im Lauf des Wochenendes in einen akzeptablen Zustand gebracht.

Aus Info2 kennen Sie: Worst-case Laufzeit eines Algorithmus bestimmen.

Hier: Betrachte Problemstellung und bestime was Wort-case Laufzeit von bestmöglichem Algorithmus ist.

\begin{Def}
Sei $f:\N\rightarrow\N$ Funktion und $\M$ eine nichtdet. \ac{TM} mit Eingabealphabet $\Sigma$.
\begin{itemize}
 \item $\M$ hat \emph{Zeitkomplexität} $f(n)$, falls $\forall w\in\Sigma^*$ mit Länge $n$ gilt: $\M$ hält auf Eingabe $w$ für jede Berechnung in höchstens $f(n)$ Schritten.
 \item $\M$ hat \emph{Platzkomplexität} $f(n)$ wenn
\end{itemize}
\end{Def}


\begin{Def}[name={[$\NTIME$ Klasse]}]
	Sei $f:\N\->\N$ eine Funktion.
	\begin{itemize}
	 \item $\DTIME(f(n)) = \{L\mid \exists \text{det. Mehrband TM $\M$ sodass $L(\M)=L$ und $\M$ hat Zeitkomplexität $f(n)$} \} $
	 \item $\NTIME(f(n)) = \{L\mid \exists \text{nichtdet. Mehrband TM $\M$ sodass $L(\M)=L$ und $\M$ hat Zeitkomplexität $f(n)$} \} $
	 \item $\DSPACE(f(n)) = \{L\mid \exists \text{det. Mehrband TM $\M$ sodass $L(\M)=L$ und $\M$ hat Platzkomplexität $f(n)$} \} $
	 \item $\NSPACE(f(n)) = \{L\mid \exists \text{nichtdet. Mehrband TM $\M$ sodass $L(\M)=L$ und $\M$ hat Platzkomplexität $f(n)$} \} $
	\end{itemize}

% 	Die Klasse $\NTIME(f(n))$ besteht aus allen Sprachen, die von einer (Mehrkanal-)\ac{TM} $M$ in $T_M(w)\leq f(|w|)$ akzeptiert werden.\\
% 	Dabei $T_M(w) =
% 	\begin{cases}
% 		\mathrlap{\text{Anzahl der Schritte einer kürzesten akzeptierenden Berechnung von $M$ auf }w}\\
% 		1 & \text{falls }\nexists
% 	\end{cases}$\\
\end{Def}

Diagramm

\bigskip

Probleme als Sprachen.

Bsp: Erfüllbarkeitsproblem der Aussagenlogik.

\begin{Def}[name={[$SAT$: Erfüllbarkeitsproblem der \acs*{AL}]}]
	$SAT$, das Erfüllbarkeitsproblem der \acf{AL} ist  definiert durch
	\begin{description}
	\item[Eingaben:] Formal $F$ der \acl{AL}.
	\item[Frage:] Ist $F$ erfüllbar, d.h. existiert eine Belegung $\beta$ der Variablen mit $\{0,1\}$, so dass $F[\beta]=1$ ist.
	\end{description}
	$SAT=\{\code(F) \mid F\text{ist erfüllbare Formel der \acs{AL}}\}$
\end{Def}

Exkurs Aussagenlogische Formel.

Bekannt aus Logik. Beschreiben unsere Notation mit Hilfe folgender Grammatik.

\begin{Bsp}\label{bsp:3.sameNumber}
  $\mathcal{G} = (\Sigma, N, P, S)$ mit
	\begin{align*}
		\Sigma &= \{ 0, 1 \}\\
		N &= \{S\}\\
		P &= \begin{aligned}[t]
      \{ S & \to 1S0S \\
        S & \to 0S1S \\
        S & \to \Eps
      \}
        \end{aligned}
      \qedhere
	\end{align*}
\end{Bsp}


$\{F\in L(G_{AL})\mid F \text{erfüllbar}\}$

Betrachen zunächst Teilmenge.

DTM?

Laufzeitkomplexität?

Exkurs
\begin{Def} Sei $g:\N\rightarrow\N$
$$\mathcal{O}(g(n)) = \{f:\N\rightarrow\N \mid \exists n_0, k\in\N \forall n\geq n_0: f(n)\leq k\cdot g(n)\}$$
\end{Def}

Anschaulich: $f(n)\in \mathcal{O}(g(n))$ $f$ wächst garantiert nicht viel stärker als $g$.


\bigskip

\begin{Def}[name={[Polynom]}]
	Ein Polynom ist eine Funktion $p:\N\->\N$ mit $\exists k\in \N\ a_0,\dots,a_k\in\N$ und \mbox{$p(n)=\sum_i^k a_in^k$}
\end{Def}
\begin{Def}
 \[ P = \bigcup_{p\text{ Polynom}} DTIME(P(n)) \]
 \[ NP = \bigcup_{p\text{ Polynom}} \NTIME(p(n)) \]
 
\end{Def}



% \begin{Def}[name={[$NP$ Klasse]}]
% 	Die Klasse $NP$ besteht aus allen Sprachen, die von \ac{NTM} in polynomieller Zeit akzeptiert werden können.
% 	\[ NP = \cup_{p\text{ Polynom}} \NTIME(p(n)) \]
% \end{Def}
% Analog für deterministische TM:
% \begin{Def}[name={[$\DTIME$ Klasse]}]
% 	Sei $f:\N\->\N$ Funktion\\
% 	$\DTIME(f(n)) =$ Klasse der Sprachen, die von \ac{DTM} in $T_M(w)\leq f(|w|)$ Schritten akzeptiert wird.
% 	\[ P = \cup_{p\text{ Polynom}} DTIME(P(n)) \qedhere \]
% \end{Def}
Offenbar $P\leq NP$. Seit 1970 weiß man nicht, ob $P=NP$ oder $P\neq NP$
\begin{description}
\item[Praktische Relevanz:] Es existieren wichtige Probleme, die offensichtlich in $NP$ liegen, aber die besten bekannten Algorithmen sind exponentiell.\\
	Beispiel: Traveling Salesman ($O(2^n)$), Erfüllbarkeit der Aussagenlogik.
\item[Struktur:] Viele der $NP$-Probleme haben sich als gleichwertig erwiesen, in dem Sinn, dass eine $P$-Lösung für alle anderen liefert.\\
	$\leadsto NP$-Vollständigkeit.
\end{description}
}

\begin{Def}[Polynomielle Reduktion]\label{def:PolyReduktion}\ \\
  Seien $U, V \subseteq \Sigma^*$ Sprachen.
  \emph{$U$ ist auf $V$ polynomiell reduzierbar (Notation: $U \preceq_p V$)}, falls eine totale, berechenbare Funktion
  $f:\Sigma^* \to \Sigma^*$ existiert, sodass
  \begin{itemize}
   \item $\forall w \in \Sigma^*:w \in U \iff f(w) \in V$
   \item $f$ wird von det. TM berechnet deren Laufzeitkomplexität ein polynom ist.
  \end{itemize}
  Wir nennen $f$ \emph{Reduktionsfunktion}.
\end{Def}

\datenote{02.02.2018}
Eine aussagenlogische Formel $F$ ist in \emph{konjunktiver Normalform} (CNF) wenn $F$ eine Konjunktion von Disjunktionen von Literalen ist.
Wir verwenden $CNF$ als Notation für die Menge aller AL Formeln in CNF.
Analog schreiben wir $3CNF$ für die Menge aller Formeln in CNF bei denen jeder Konjukt aus höchstens drei Disjunkten besteht.



\begin{Def}[name={[$3SAT$]}]
Das Problem 3SAT ist wie folgt definiert.\footnote{
Typischerweise nennt man Sprachen die im kontext der Komplexitätstheorie definiert wernden \emph{Probleme}.
Es ist üblich von einem konkretes Alphabet $\Sigma$ und keine konkrete Codierung der Objekte (hier Formeln) zu abstrahieren und das Problem als (Gegeben,Frage)-Paar zu formulieren.
Es bleibt dem Leser überlassen sich selbst ein geeignete Alphabete und Codierungen zu überlegen.
Für den Fall von aussagenlogische Formeln haben wir dies in ... nocheinmal gemacht, werden aber in Zukunft darauf verzichten. }
\begin{center}
\framebox[\textwidth]{\parbox{.95\textwidth}{
\smallskip
\textit{Gegeben:} Eine aussagenlogische Formel $F\in$ 3CNF

\medskip

\textit{Frage:} Ist $F$ erfüllbar.
}}
\end{center}
	
\end{Def}
Alternativ könnten wir die Definition von $3SAT$ auch wie folgt aufschreiben.
$$3SAT = \{F\in L(\mathcal{G}_\mathsf{AL})\mid F \text{ ist in CNF und hat höchstens 3 Literale pro Klausel}\}$$

Offensichtlich gilt $3SAT \preceq_p SAT$.\footnote{
In der Vorlesung vom 02.02. wurde (fälschlicherweise) gesagt, die Identität sei eine geeignete Reduktionsfunktion.
Dies ist nicht korrekt, da z.B. 
$(A_1\lor A_2\lor A_3\lor A_4)\notin 3SAT$
(weil nicht in 3CNF) aber $(A_1\lor A_2\lor A_3\lor A_4)\in SAT$.
} Wir zeigen als nächstes auch die umgekehrte Richtung.

\begin{lemma}\label{lem:sat3sat}
	$SAT \preceq_p 3SAT$
\end{lemma}


\begin{proof}
Unser Zeil ist nun eine Transformation anzugeben die sich in polynomieller Zeit berechnen lässt, die jede Aussagenlogische Formel $F_\mathsf{AL}$ in eine 3CNF Formel $F_\mathsf{3CNF}$ überführt, sodass 
$F_\mathsf{AL}\in SAT \<==> F_\mathsf{3CNF}\in 3SAT$
gilt.

Sei $F_\mathsf{AL}$ eine beliebige Formel aus $L(\mathcal{G}_\mathsf{AL})$.

\begin{enumerate}
 \item Erzeuge aus $F_\mathsf{AL}$ eine äquivalente Formel $F_\mathsf{NNF}$ in Negationsnormalform\footnote{Eine Formel ist in Negationsnormalform wenn der Negationsoperator immer nur direkt vor einer Variablen vorkommt.}.
 Wir können jede Formel in Negationsnormalform bringen indem wir mit Hilfe der De Morganschen Regeln die Negationen ``nach innen'' ziehen.
 
 Beispiel: $\neg(\neg (A_1\lor \neg A_3)\land A_2) \quad\rightsquigarrow\quad ((A_1\lor \neg A_3)\land \neg A_2)$
 
 Ideen zur Implementierung: Erstelle auf zusätzlichem Band eine Kopie der Formel. 
 Lasse vor jedem nicht negierten Literal ein Feld Platz um später ggf. ein Negationssymbol zu plazieren.
 Wende De Morgans Regel von Aussen nach Innen an.
 Laufe für jede Anwendung ein mal über die Formel.
 
 
 \item Erzeuge aus $F_\mathsf{NNF}$ eine Formel $F_{\alpha\gamma}$ mit Biimplikationszeichen ``$\<->$'' mit Hilfe der folgenden induktiv definierten Abbildungen $\alpha$ und $\gamma$.\footnote{
 Die hier beschriebene Transformation ist auch als Tseytin-Transformation bekannt.}
 
 Idee: Die Abbildung $\gamma$ liefert für jede $\land$-Teilformel und jede $\lor$-Teilformel eine neue Hilfsvariable.
 Diese Hilfsvariable hat in der Resultierenden Formel den Wahrheitswert, den die entsprechende Teilformel in der Eingabeformel hätte.
 Die Abbildung $\alpha$ konstuiert für jede Teilformel die entsprechenden Bedingungen für die Hilfsvariable.
 Erzeugt $\gamma$ keine Hilfsvariable, erzeugt $\alpha$ die (nicht einschränkende) Bedingung $1$.
 
 $$\gamma(F)=
 \begin{cases}
   0 & \text{ falls } F=0\\
   1 & \text{ falls } F=1\\
   A & \text{ falls } F=A\\
   \neg F_1 & \text{ falls } F=\neg F_1\\
   B_F & \text{ falls } F=F_1\land F_2\\
   B_F & \text{ falls } F=F_1\lor F_2
  \end{cases}$$
 
 
 
 $$\alpha(F)=
 \begin{cases}
   1 & \text{ falls } F=0\\
   1 & \text{ falls } F=1\\
   1 & \text{ falls } F=A\\
   1 & \text{ falls } F=\neg F_1\\
   \big(\gamma(F)\<-> \gamma(F_1) \land \gamma(F_2)\big)\land\alpha(F_1)\land\alpha(F_2) & \text{ falls } F=F_1\land F_2\\
   \big(\gamma(F)\<-> \gamma(F_1) \lor \gamma(F_2)\big)\land\alpha(F_1)\land\alpha(F_2) & \text{ falls } F=F_1\lor F_2
  \end{cases}$$
  
  Wir definieren das Resultat $F_{\alpha\gamma}:=\gamma(F_\mathsf{NNF})\land \alpha(F_\mathsf{NNF})$
  
  Beispiel:
  \begin{align*}
   \alpha((A_1\lor \neg A_3)\land \neg A_2)) = & \;
  \big(B_{((A_1\lor \neg A_3)\land \neg A_2)} \leftrightarrow (B_{(A_1\lor \neg A_3)} \land \neg A_2)\big)\\
  & \land (B_{(A_1\lor \neg A_3)} \leftrightarrow (A_1\lor \neg A_3)) \land 1 \land 1\\
  & \land 1
  \end{align*}

  
  Ideen zur Implementierung:
  
  Wähle Bandalphabet so dass $B$ enthalten, verwende außerde eine zusätzlich Art von Klammern (z.B. eckige Klammern) um den Subscriptanteil der B-Variablen von anderem Bandinhalt zu unterscheiden.
  Laufe für jede $\{\land,\lor\}$-Teilformel einmal über die Eingabe.
  Zusätzliches Band zum Schreiben von Resultat.
  Zusätzliches Band für aktuell bearbeitete $\{\land,\lor\}$-Teilformel da diese immer zwei mal benötigt wird (Variablenname und $\alpha$)
  Bearbeite äußere Teilformeln vor inneren.
  Lösche Teile die nicht mehr benötigt werden.
\item Ersetze die Formelteile mit Biimplikationszeichen in $F_{\alpha\gamma}$ wie folgt durch logisch äquivalente Formeln in 3CNF.
	\begin{itemize}
	\item $F_1\<-> (F_2\land F_3)
% 		= \big(F_1\land (F_2\land F_3)\big)\lor \big(\neg F_1\land \neg(F_2\land F_3)\big)
% 		= \big(F_1\lor \neg(F_2\land F_3)\big)\land \big(\neg F_1\lor (F_2\land F_3)\big)
		\quad\rightsquigarrow\quad \big(F_1\lor \neg F_2\lor \neg F_3\big)\land \big(\neg F_1\lor F_2\big)\land \big(\neg F_1\lor F_3\big)
		$
	\item $F_1\<-> (F_2\lor F_3)
% 		= \big(F_1\lor \neg(F_2\lor F_3)\big)\land \big(\neg F_1\lor (F_2\lor F_3)\big)
		\quad\rightsquigarrow\quad \big(F_1\lor \neg F_2\big)\land\big(F_1\lor \neg F_3\big)\land \big(\neg F_1\lor F_2\lor F_3\big)
$
	\end{itemize}
	
	Ideen zur Implementierung:
	
	Zusätzliches Band zum Schreiben von Resultat.
    Zusätzliches Band für Operanden der Biimplikation da diese immer mehrfach benötigt werden.
  
\item Ersetzte alle Aussagenlogischen Variablen der Form $B_F$ durch aussagenlogische Variablen der Form $A_i$.\footnote{
Dieser Schritt ist nur nötig damit das Resultat in dem von uns definierten Alphabet $\Sigma_{AL}$ dargestellt werden kann.
Alternativ hätten wir auch zu Beginn ein Reichhaltigeres Alphabet wählen können.
}

	Ideen zur Implementierung:
	
    Finde zunächst höchsten Index $i_{max}$ von $A_i$ Variablen (speichere akutelles Maximum auf zusätzlichem Band).
    Verwende anschließend $i_{max}+1, i_{max}+2, \ldots$ für neue Variablen.
    Schreibe zunächst eine Übersetzungsvorschrift (z.B. $A_4:=B_{((A_1\lor \neg A_3)\land \neg A_2)}, A_4:=B_{(A_1\lor \neg A_3)}$) auf ein zusätzliches Band und ersetze erst dann.

\end{enumerate}

Sei $f:\Sigma_{AL}\rightarrow\Sigma_{AL}$ eine Funktion die alle Formeln aus $L(\mathcal{G}_\mathsf{AL})$ ensprechend obiger Konstuktion abbildet und alle anderen Wörter unverändert lässt, dann gilt:
\begin{itemize}
 \item $F_{AL}\in SAT \<==> f(F_{AL})\in 3SAT$ (hier ohne Beweis)
 \item $f$ ist total und lässt sich in polynomieller Zeit berechnen (hier ohne Beweis)
\end{itemize}



\end{proof}



\begin{lemma}\label{lem:A<B + BinP => AinP}
	Falls $A\preceq_p B$ und $B\in P$ (bzw. $NP$) dann auch $A\in P$ (bzw. $NP$).
\end{lemma}
\begin{proof}
	$B\in P: \exists M$, die $B$ in $p(n)$ Schritten akzeptiert.\\
	$\exists M_f$, die die Reduktion $A\preceq_p B$ implementiert. Die Laufzeit von $M_f$ sei durch $q$ Polynom beschränkt.\\
	Betrachte $M'=$"'erst $M_f$, dann $M$ auf dem Ergebnis"'
	$M'$ akzeptiert $A$.\\
	$w\in A\ M_f(w)$ liefert $f(w)$ in $\subseteq q(|w|)$ Schritten ohne $|f(m)|\subseteq q(|w|)$\\
	$M(f(w))$ benötigt $\leq p(|f(w)|)\leq p(q(|w|))$ Schritte zum akzeptieren.\\
	$\curvearrowright A\in \DTIME(q(w)+p(q(w))\subseteq P$
\end{proof}


% \draftnote{8.2.17}

\begin{Def}[name={[$NP$-schwierig und $NP$-vollständig]}]\
	\begin{itemize}
	\item Eine Sprache $U$ heißt \emph{$NP$-schwierig}, falls $\forall L\in NP : L\preceq_p U$.
	\item Eine Sprache $U$ heißt \emph{$NP$-vollständig}, wenn $U$ $NP$-schwierig und $U\in NP$. \qedhere
	\end{itemize}
\end{Def}

{\color{red}
TODO: Ausformulieren
\begin{itemize}
 \item $NP$-schwierig, sehr starke Forderung dass an alle(!) NP Probleme reduzieren kann
 \item zunächst unklar ob es überhaupt ein $NP$-schwieriges Problem gibt
 \item bedeutet wenn ich das $NP$-vollst. Problem gefunden habe dass ich effizient Lösen kann, kann ich alle NP Probleme effizient lösen (wie folgender Satz zeigt).
\end{itemize}
}
\begin{Satz}
	Wenn $A\ NP$-vollständig ist, dann gilt die folgende Äquivalenz.
	\[ A\in P \<==> P=NP \]
\end{Satz}
\begin{proof}\ \\
	"`\<=="' trivial.\\
	"`\==>"' $A\in P\subseteq NP\quad \forall L\in NP: L\preceq_p A$. Nach \autoref{lem:A<B + BinP => AinP} : $L\in P$
\end{proof}

\begin{lemma}[name={[$\preceq_p$ ist reflexiv und transitiv]}]
	$\preceq_p$ ist reflexiv und transitiv.
\end{lemma}
\begin{proof}
Übungsblatt~14, Aufgabe~1.
% 	Identität; ähnlich wie Beweis von \autoref{lem:A<B + BinP => AinP}.
\end{proof}

\begin{Bem}
    Aus der Transitivität folgt:
	Sobald eine $NP$-schwieriges Problem $U$ bekannt ist, reicht es $U\preceq_p V$ zu finden, um zu zeigen, dass $V$ ebenfalls $NP$-schwierig ist.
\end{Bem}
% Ein erstes $NP$-vollständiges Problem.

\begin{Satz}[Cook]\label{satz:cook}
	$SAT$ ist $NP$-vollständig.
\end{Satz}
Wir werden nur für $SAT$ die NP-Schwierigkeit direkt Beweisen und für alle anderen $NP$-vollständigen Probleme die $NP$-Schwierigkeit wie in obiger Bemerkung angedeutet mit Hilfe einer polynomiellen Reduktion zeigen.
Da der Beweis von \autoref{satz:cook} sehr Umfangreich ist wollen wir diesen etwas aufschieben und zunächt die $NP$-Vollständigkeit weiterer Probleme zeigen.


\begin{Satz}[name={[$3SAT$ ist $NP$-vollständig]}]
	$3SAT$ ist $NP$-vollständig.
\end{Satz}
\begin{proof}
 \begin{itemize}
  \item $3SAT\in NP$
  
  Wir können dies auf zwei Arten zeigen. 
  Entweder wir zeigen direkt, dass es eine nichtdeterministische \ac{TM} gibt die $3SAT$ entscheidet oder 
  wir Zeigen dies indirekt mit Hilfe einer polynomiellen Reduktion auf ein Problem in $NP$.
  Wir wählen letzteres Vorgehen da zum Beweis nur nochmal erwähnt werden muss dass $SAT\in NP$ und (offensichtlich) $3SAT\preceq_p SAT$ gilt.
  
  \item $3SAT$ ist NP-schwierig
  
  Folgt aus \autoref{lem:sat3sat}.\qedhere
 \end{itemize}
\end{proof}


Wir gehen davon aus, dass die Leser des Skiptes mit Graphen vertraut sind, machen aber zum fixieren von Notation und Terminologie die folgende Definition.
\begin{Def}
 Ein \emph{gerichteter Graph} ist ein Paar $\mathcal{G}=(V,E)$ bei dem 
 \begin{itemize}
  \item $V$ eine Menge ist, deren Elemente wir \emph{Knoten} nennen und
  \item $E\subseteq V\times V$ eine Menge von geordneten Paaren über $V$ ist. 
  Wir nennen diese geordneten Paare \emph{Kanten}.
 \end{itemize}
 Ein \emph{ungerichteter Graph} ist ein gerichteter Graph bei dem $E$ symmetrisch ist.\footnote{Für die Zwecke dieser Vorlesung ist es komfortabel den ungerichteten Graphen als Speziallfall des gerichteten Graphen zu definieren. Eine häufig verwendete Alternative ist, die Knotenmenge als Menge von zweielementigen Mengen zu definieren.}
\end{Def}



\begin{Def}[$\CLIQUE$]
    Das Problem $\CLIQUE$ ist wie folgt definiert.
    \begin{center}
    \framebox[\textwidth]{\parbox{.95\textwidth}{
    \smallskip
    \textit{Gegeben:} Ein ungerichteter Graph $\mathcal{G}=(V,E)$ und eine Zahl $k\in\N$.

    \medskip

    \textit{Frage:} Hat $\mathcal{G}$ eine $k$-Clique?
    
    Eine $k$-Clique ist eine $k$-elementige Menge von Knoten die paarweise durch Kanten verbunden sind.
    D.h. eine Menge $C$ soass $|C|=k$ und $\forall u, v\in C: u\neq v\rightarrow (u,v)\in E$.
    }}
    \end{center}
\end{Def}
\begin{Satz}[name={[$\CLIQUE$ ist $NP$-vollständig]}]
	$\CLIQUE$ ist $NP$-vollständig.
\end{Satz}
\begin{Bemerkung}
 Der folgende Beweis ist für ein Vorlesungsskript sehr knapp gehalten.
 Der Beweis enthält aber genau die Informationen die wir in Übungsaufgaben und Klausur zum erreichen der maximalen Punktzahl erwarten würde.
 
 Beweise der $NP$-Vollständigkeit folgen typischerweise dem hier verwendeten Schema.
 Der schwierige (und sehr viel Kreativität erfordernde) Teil ist dabei eine geeignete Konstruktion für die Reduktionsfunktion zu finden.
 Für den folgenden Beweis wird die Idee der Konstuktion in \autoref{fig:3sat-clique} mit Hilfe eines Beispieles illustriert.
 
 In unserem Übungs- und Klausuraufgeben wird die Aufgabenstellung meist solch ein Beispiel enthalten.
 Damit soll ein Hinweis auf eine geeignete Konstruktion gegeben werden.
 Eine Besonderheit des folgenden Beweises ist dass die Konstuktion aus zwei Schritten besteht (Erweiterung Eingabeformel, Konstuktion Graph) Beide Schritte werden in \autoref{fig:3sat-clique} illustriert.
\end{Bemerkung}

\begin{proof}
    \begin{itemize}
     \item Zeige $\CLIQUE\in NP$.
     
     Verfahren: 
     Wähle nichtdeterministisch eine $k$-Elementige Knotenmenge $C$.
     Prüfe ob $C$ Clique ist.
     Dies ist in polynomieller Laufzeit möglich, da wir für jedes Knotenpaar höchstens einmal die Menge der Kanten durchlaufen müssen.
     
     \item Zeige das $\CLIQUE$ $NP$-schwierig mit Hilfe der Reduktion  $3SAT \preceq_p \CLIQUE$.
     
     Ziel: Konstruiere für gegebene 3CNF Formel $F$ einen Graphen $\mathcal{G}=(V,E)$ sodass $F\in 3SAT$ genau dann wenn $\mathcal{G}$ eine $k$-Clique hat.
     
     Unsere Konstruktion besteht aus zwei Schritten.
     
     \begin{itemize}
      \item Schritt 1.
      
      Erweitere $F$ so dass jeder Konjunkt aus genau drei Disjunkten besteht.
      Wähle hierfür eine Äquivalenzumformung die einfach nur existiende Disjunkte wiederholt werden.
      Das resultierende $F$ hat also die folgende Form.
      
      $F = \bigwedge\limits_{i=1}^m (z_{i,1}\lor z_{i,2}\lor z_{i,3})$ \ wobei\ $z_{i,j}\in \{A_1,\dots,A_n\}\cup\{\neg A_1,\dots,\neg A_n\}$
      \item Schritt 2.
      	Definiere $\mathcal{G} = (V,E)$ und $k$ wie folgt:
	\begin{align*}
		V &= \{ (i,j) \mid 1\leq i\leq m, j\in\{1,2,3\} \}\\
		E &= \{\big((i,j),(p,q)\big) \mid i\neq p, z_{i,j}\neq\neg z_{p,q}\}\\
		k &= m
	\end{align*}
     \end{itemize}

    Nun gilt:
    
    \begin{align*}
    F \text{ ist erfüllbar } \<==> \;\; & \text{Es gibt Folge $z_{1,j_2},\dots,z_{m,j_m}$ sodass $F$ wahr unter einer}\\
    & \text{Belegung die jedem Folgeglied $1$ zuordnet.}\\
    \<==> \;\;   & \text{Es gibt Folge $z_{1,j_2},\dots,z_{m,j_m}$ sodass $\forall i\neq p: z_{i,j_i}\neq \neg z_{p,j_p}$}\\
    \<==> \;\;   & \text{$\mathcal{G}$ hat Menge von Knoten $\{(1,j_1),\dots,(m,j_m)\}$}\\
    & \text{die paarweise durch Kanten verbunden sind.}\\
    \<==> \;\;   & \text{$\mathcal{G}$ hat $k$-Clique für $k=m$}\\
    \end{align*}
    
    Es gibt eine Reduktionsfunktion die diese Konstruktion in polynomieller Zeit berechnet und somit gilt $3SAT \preceq_p \CLIQUE$.
    \end{itemize}
\end{proof}



 \begin{figure}[H]
 \framebox{
 \begin{minipage}{0.96\textwidth}
 Die Formel 
 $$ (X\lor\neg Y)\land (Y\lor \neg X)\land (X\lor Y) $$
 ist in 3CNF. Die folgende Formel ist äquivalent und jeder Konjunkt besteht aus drei Disjunkten.
 $$ \underbrace{(X\lor\neg Y\lor \neg Y)}_{1}\land \underbrace{(Y\lor \neg X\lor\neg X)}_{2}\land \underbrace{(X\lor X\lor Y)}_{3} $$
 Die Belegung $\beta$ definiert druch $\beta(X)=1, \beta(Y)=1$ ist eine erfüllende Velegung für diese Formel,
 da z.B. der erste Disjunkt im ersten Konjunkt, der erste Disjunkt im zweiten Konjunkt und der dritte Disjunkt im zweiten Konjunkt auf 1 gesetzt sind.
 
 Im folgenden Graphen bilden die Knoten $(1,1)$, $(2,1)$ und $(3,1)$ eine $3$-Clique.
 
 \centering
\begin{tikzpicture}[
% node distance=1mm
]
\node (11) at (-2,-1.5) {$(1,1)$};
\node (12) at (0,-1.5) {$(1,2)$};
\node (13) at (2,-1.5) {$(1,3)$};

\node (21) at (-2,3) {$(2,1)$};
\node (22) at (-3,2) {$(2,2)$};
\node (23) at (-4,1) {$(2,3)$};

\node (31) at (2,3) {$(3,1)$};
\node (32) at (3,2) {$(3,2)$};
\node (33) at (4,1) {$(3,3)$};

\node (11v) [node distance=1mm, below =of 11] {$X$};
\node (12v) [node distance=1mm, below =of 12] {$\neg Y$};
\node (13v) [node distance=1mm, below =of 13] {$\neg Y$};

\node (21v) [node distance=1mm, above left =of 21] {$Y$};
\node (22v) [node distance=1mm, above left =of 22] {$\neg X$};
\node (23v) [node distance=1mm, above left =of 23] {$\neg X$};

\node (31v) [node distance=1mm, above right =of 31] {$X$};
\node (32v) [node distance=1mm, above right =of 32] {$X$};
\node (33v) [node distance=1mm, above right =of 33] {$Y$};

\draw[-] (11) to (21);
\draw[-] (11) to (31);
\draw[-] (11) to (32);
\draw[-] (11) to (33);

\draw[-] (12) to (22);
\draw[-] (12) to (23);
\draw[-] (12) to (31);
\draw[-] (12) to (32);

\draw[-] (13) to (22);
\draw[-] (13) to (23);
\draw[-] (13) to (31);
\draw[-] (13) to (32);

\draw[-] (21) to (31);
\draw[-] (21) to (32);
\draw[-] (21) to (33);

\draw[-] (22) to (33);
\draw[-] (23) to (33);
\end{tikzpicture}
\end{minipage}
}
	\caption{Beispiel zu $3SAT \preceq_p \CLIQUE$}
	\label{fig:3sat-clique}
\end{figure}






\begin{Bsp*}
	\begin{align*}
	F &= (\underbrace{x\lor y\lor \overline{y}}_1) \land (\underbrace{z\lor \overline{y} \lor \overline x}_2)\\
	\mathcal{G} &: \tikz[baseline=(11.base),label distance=-.5em]\graph[math nodes, chain shift={(0,-1)}, group shift={(1,0)}]{
		{x[label={[name=11](1,1)}], y[label={(1,2)}], "\overline y"[label={(1,3)}]}
		--[complete bipartite] 
		{z[label={below:(2,1)}], 22/\overline y[label={below:(2,2)}], "\overline x"[label={below:(2,3)}]}
	};
	\end{align*}\rlnote{Grafik überprüfen}
\end{Bsp*}

\begin{proof}\
	\begin{enumerate}
	\item $SAT\in NP$\\
		Rate nicht deterministisch eine Belegung $\beta$\\
		Werte $F[\beta]$ aus\\
		$\curvearrowright$ in $\NTIME(n)$, polynomiell
	\item $SAT$ ist $NP$-hart.\\
		Zeige: $\forall L\in NP : L \preceq_p SAT$\\
		$L\in NP : \exists p$ Polynom, \ac{NTM} $M$ mit $L=L(M)$ mit Zeitschranke $T_M(w)\leq p(|w|)$.
		
		Sei $w = x_1\dots x_n\in\Sigma^*$ Eingabe für $M$.\\
		Definiere $F$, so dass $F$ erfüllbar $\<==> M$ akzeptiert $w$
		
		Sei $Q=Q(M)$ mit $\{q_1,\dots,q_k\}=Q$\\
		Sei $\Gamma = \Gamma(M)$ mit $\{a_i,\dots,a_l\} = \Gamma$\\
		Definiere folgende Variablen zur Ver. in $F$
		\begin{itemize}
		\item $\mathrm{state}(t,q) = 1$, genau dann wenn $M$ nach $T$ Schritten im Zustand $q$
		\item $\mathrm{pos}(t,i) = 1$, gdw. der Kopf von $M$ steht nach $t$ Schritten auf Position $i$.\\
		$t\in\{0,\dots P(n)\}$\\
		$i\in \{-p(n),\dots,0,1,\dots,p(n)\}$
		\item $\mathrm{tape}(t,i,a) = 1$, gdw. nach $t$ Schritten befindet sich $a$ an Position $i$ auf dem Band.\\
		$t\in\{0,\dots,p(n)\}$\\
		$i\in\{-p(n),\dots,p(n)\}$\\
		$a\in\Gamma$ \qedhere
		\end{itemize}
	\end{enumerate}
\end{proof}
\begin{lemma}
	Für jedes $k\in\N$ existiert eine Formel $G$, sodass $G(x_i,\dots,x_k)=1$ gdw. $\exists j: x_j = 1$ und $\forall i \neq j: x_i = 0$. Es gilt $|G| \in O(k^2)$.
\end{lemma}
\begin{proof}
	\[ G(x_i,\dots,x_k) = \bigvee_{i=1}^k x_i\land \bigwedge_{i\neg j}\neg (x_i\land x_j) \]
	$M=(Q,\Sigma,\Gamma,\delta,q_0,\blank,F)$ erkennt $L$ in $\NTIME(p),\ p$ Polynom.
	
	Ziel: Konstruiere aus $M,w$ eine Formel $F$, so dass
	\begin{align*}
		F\text{ erfüllbar} &\<-> M\text{ akzeptiert }w\\
		\state(t,q) &\phantom{\<->} t\in 0,\dots,p(n), q\in Q\\
		&\<=>\text{ nach $t$ Schritten ist $M$ in Zeile }q\\
		\pos(t,i) &\<=>\text{ nach $t$ Schritten ist Kopf amn Pos } i\quad,\quad -p(n)\leq i\leq p(n)\\
		\tape(t,i,a) &\<=>\text{ nach $t$ Schritten enthält Band}[i] = q\in\Gamma\\
		F &= R \land A\land T_1
	\end{align*}
	\begin{enumerate}
	\item Randbedingungen
		\begin{align*}
			R =&\phantom{\land}\, \bigwedge_t G(\state(t,q1),\dots,\state(t,q_k))\\
			& \land \bigwedge_t G(\pos(t,-p(n)),\dots,\pos(t,D),\dots,\pos(t,p(n)))\\
			& \land \bigwedge_{t,i} G(\tape(t,i,a_1),\dots,\tape(t,i,a_l)
		\end{align*}
	\item Anfangskonfiguration
		\begin{align*}
			A =&\phantom{\land}\; \state(0,q_1)\land \pos(0,1)\\
			&\land\tape(0,1,x_1)\land\dots\land\tape(0,n,x_n)\\
			&\land\bigwedge_{-p(n)\leq i\leq p(n)} \tape(0,i,\blank)
		\end{align*}
	\item Transitionsschritte
	\begin{align*}
		T_1 =& \bigwedge_{\substack{t\in 0,\dots,p(n)-1,\\i,n}} \state(t,q)\land \pos(t,i) \land \tape(t,i,a)\\
		&\-> \state(z+1,q')\land \pos(t+1,i+d) \land \tape(t+1,i,a')\\
		&\delta(q,a)\ni(q',a',d)\\
		&d\in\{-1,a,1\}\\
		T_2 =& \bigwedge_{\substack{t,i,q\\t<p(n)}} \neg \pos(t,i)\land \tape(t,i,a) \-> \tape(t+1,i,a)
	\end{align*}
	\item Endkonfiguration
		\[ E = \bigvee_{q\in F} \state(p(n),q) \]
		$|F|$ ist polznomiell beschränkt in $|M,w|$, also $L\preceq_p \mathrm{SAT}$\\
		$\curvearrowright\ \mathrm{SAT}$ ist $NP$-vollständig.
	\end{enumerate}
\end{proof}

\subsection{Weitere \textit{NP}-vollständige Probleme}


